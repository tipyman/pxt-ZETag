<xml xmlns="https://developers.google.com/blockly/xml"><block type="pxt-on-start" id="K~rvw9S]}XYgnx=Y;[W6" x="0" y="0"><statement name="HANDLER"><block type="typescript_statement" id="a^c#ZaNyl~8nFE1{M@O^" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="let Para_array: number[] = []" numlines="1" declaredvars="Para_array"></mutation><next><block type="typescript_statement" id="R{,EMt`I`V.3s3{P0[pT" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="let ch_spacing = 0" numlines="1" declaredvars="ch_spacing"></mutation><next><block type="typescript_statement" id="ZTZkS*#ISwGN[091%{AP" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="let CheckSum = 0" numlines="1" declaredvars="CheckSum"></mutation><next><block type="typescript_statement" id="tu.V]eC/ngw?-yxF+MN(" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="let o = 0" numlines="1" declaredvars="o"></mutation><next><block type="typescript_statement" id="j*Co#Y54$z5]!j,0tW2." editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="let TX_Power_data = 0" numlines="1" declaredvars="TX_Power_data"></mutation><next><block type="typescript_statement" id="I7{cek,M_t3(B2xw{C6D" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="let ch_num = 0" numlines="1" declaredvars="ch_num"></mutation><next><block type="typescript_statement" id="t6pya;M/eEY%~)9xXjK%" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="let Base_frequency = 0" numlines="1" declaredvars="Base_frequency"></mutation><next><block type="typescript_statement" id="Wk9;CtAe@M?![ACm5s#{" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="let Counter2 = 0" numlines="1" declaredvars="Counter2"></mutation><next><block type="typescript_statement" id="sAICzV3HrY|ZeqeMS{*9" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="namespace ZETag {" line1="    //% blockId=Channel_Spacing block=&quot;ZETag Set Channel Space&quot;" line2="    //% CH_Space.min=100 CH_Space.max=200 CH_Space.defl=100" line3="    export function Set_channel_spacing(CH_space: number) {" line4="        if (CH_space &gt; 200) {" line5="            ch_spacing = 200" line6="        } else {" line7="            ch_spacing = CH_space" line8="        }" line9="        // FF 00 03 F0 64 56; 100KHz設定" line10="        // FF+00+03+F0=1F2=498(10)" line11="        Send_Uart_data([" line12="            255," line13="            0," line14="            3," line15="            240," line16="            ch_spacing," line17="            (498 + ch_spacing) % 256" line18="        ], 6)" line19="    }" line20="" line21="    //% blockId=Send_data block=&quot;ZETag Send ZETag data&quot;" line22="    export function Send_data(data_array: number[], num: number) {" line23="        // 255+2+128=385" line24="        // FF 00 02 80" line25="        CheckSum = 385 + num" line26="        Send_Uart_data([" line27="            255," line28="            0," line29="            num + 2," line30="            128" line31="        ], 4)" line32="        o = 0" line33="        for (let index = 0; index &lt; num; index++) {" line34="            bserial.binserial_write(data_array[o])" line35="            basic.pause(5)" line36="            CheckSum = CheckSum + data_array[o]" line37="            o += 1" line38="        }" line39="        bserial.binserial_write(CheckSum % 256)" line40="        basic.pause(5)" line41="    }" line42="" line43="    //% blockId=TX_Power block=&quot;ZETag TX Power&quot;" line44="    export function Set_TX_Power(TX_Power: number) {" line45="        if (TX_Power &gt; 10) {" line46="            TX_Power_data = 20" line47="        } else {" line48="            TX_Power_data = TX_Power * 2" line49="        }" line50="        // FF 00 03 41 10 53; 出力8dB設定" line51="        // FF+00+03+41=143=323(10)" line52="        Send_Uart_data([" line53="            255," line54="            0," line55="            3," line56="            65," line57="            TX_Power_data," line58="            (323 + TX_Power_data) % 256" line59="        ], 6)" line60="    }" line61="" line62="    //% blockId=Send_Uart_data block=&quot;ZETag Send uart data&quot;" line63="    export function Send_Uart_data(data_array: number[], num: number) {" line64="        o = 0" line65="        for (let n = 0; n &lt;= num - 1; n++) {" line66="            bserial.binserial_write(data_array[n])" line67="            basic.pause(5)" line68="        }" line69="    }" line70="" line71="    //% blockId=Set_Frequency block=&quot;ZETag Set Frequency&quot;" line72="    //% CH_num.min=1 CH_num.max=6 CH_num.defl=1" line73="    export function Set_Frequency(Frequency: number, CH_num: number, step: number) {" line74="        if (step == 0) {" line75="            o = 1" line76="        } else if (step &gt;= 2) {" line77="            o = 2" line78="        } else {" line79="            o = step" line80="        }" line81="        if (CH_num &lt;= 1) {" line82="            ch_num = -1" line83="        } else if (CH_num &gt; 6) {" line84="            ch_num = 6" line85="        } else {" line86="            ch_num = CH_num" line87="        }" line88="        Base_frequency = Frequency" line89="        CheckSum = 0" line90="        Para_array = [" line91="            255," line92="            0," line93="            8 + ch_num," line94="            64," line95="            1," line96="            Math.idiv(Base_frequency, 16777216)," line97="            Math.idiv(Base_frequency, 65536) % 256," line98="            Math.idiv(Base_frequency, 256) % 256," line99="            Base_frequency % 256," line100="            ch_num," line101="            0," line102="            0," line103="            0," line104="            0," line105="            0," line106="            0," line107="            0" line108="        ]" line109="        if (ch_num &gt;= 2) {" line110="            for (let Counter = 0; Counter &lt;= ch_num - 1; Counter++) {" line111="                Para_array[10 + Counter] = Counter * o" line112="            }" line113="        } else {" line114="            Para_array[4] = 0" line115="        }" line116="        Counter2 = 0" line117="        for (let index2 = 0; index2 &lt; ch_num + 10; index2++) {" line118="            CheckSum = CheckSum + Para_array[Counter2]" line119="            Counter2 += 1" line120="        }" line121="        CheckSum = CheckSum % 256" line122="        Para_array[10 + ch_num] = CheckSum" line123="        Send_Uart_data(Para_array, 11 + ch_num)" line124="    }" line125="}" numlines="126"></mutation></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></statement></block></xml>