<xml xmlns="https://developers.google.com/blockly/xml"><block type="pxt-on-start" id="|V/8SuK@OAHy2ko=MNVO" x="0" y="0"><statement name="HANDLER"><block type="typescript_statement" id="-u,L{CtSpZXW!?.R!bC^" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="let Counter2 = 0" numlines="1" declaredvars="Counter2"></mutation><next><block type="typescript_statement" id="0#:4duP##FG*F@Rwi9!K" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="let Base_frequency = 0" numlines="1" declaredvars="Base_frequency"></mutation><next><block type="typescript_statement" id="br39=q3C:GCkMSO[-@.0" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="let ch_num = 0" numlines="1" declaredvars="ch_num"></mutation><next><block type="typescript_statement" id="dW#r$3Mx-Z*n-g-{:;t0" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="let TX_Power_data = 0" numlines="1" declaredvars="TX_Power_data"></mutation><next><block type="typescript_statement" id="nhFs6$.=Cs6Xtk~%[Usm" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="let o = 0" numlines="1" declaredvars="o"></mutation><next><block type="typescript_statement" id="_}fg~N27WI3ekFpWtzN1" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="let CheckSum = 0" numlines="1" declaredvars="CheckSum"></mutation><next><block type="typescript_statement" id="E}64-}nDtOe(oU;(f;K`" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="let ch_spacing = 0" numlines="1" declaredvars="ch_spacing"></mutation><next><block type="typescript_statement" id="~%q`3)jNMHyQl,CFC?)l" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="let Para_array: number[] = []" numlines="1" declaredvars="Para_array"></mutation><next><block type="typescript_statement" id="1n:c=ZR4jZv3c$CJvneA" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="namespace ZETag {" line1="    //% blockId=Channel_Spacing block=&quot;ZETag Set Channel Space %text&quot;" line2="    //% CH_Space.min=100 CH_Space.max=200 CH_Space.defl=100" line3="    export function Set_channel_spacing(CH_space: number) {" line4="        if (CH_space &gt; 200) {" line5="            ch_spacing = 200" line6="        } else {" line7="            ch_spacing = CH_space" line8="        }" line9="        // FF 00 03 F0 64 56; 100KHz設定" line10="        // FF+00+03+F0=1F2=498(10)" line11="        Send_Uart_data([" line12="            255," line13="            0," line14="            3," line15="            240," line16="            ch_spacing," line17="            (498 + ch_spacing) % 256" line18="        ], 6)" line19="    }" line20="" line21="    //% blockId=Send_data block=&quot;ZETag Send ZETag data %text %text&quot;" line22="    export function Send_data(list: number[], e_num: number) {" line23="        // 255+2+128=385" line24="        // FF 00 02 80" line25="        CheckSum = 385 + e_num" line26="        Send_Uart_data([" line27="            255," line28="            0," line29="            e_num + 2," line30="            128" line31="        ], 4)" line32="        o = 0" line33="        for (let index = 0; index &lt; e_num; index++) {" line34="            bserial.binserial_write(list[o])" line35="            basic.pause(5)" line36="            CheckSum = CheckSum + list[o]" line37="            o += 1" line38="        }" line39="        bserial.binserial_write(CheckSum % 256)" line40="        basic.pause(5)" line41="    }" line42="" line43="    //% blockId=TX_Power block=&quot;ZETag TX Power %text&quot;" line44="    export function Set_TX_Power(TX_Power: number) {" line45="        if (TX_Power &gt; 10) {" line46="            TX_Power_data = 20" line47="        } else {" line48="            TX_Power_data = TX_Power * 2" line49="        }" line50="        // FF 00 03 41 10 53; 出力8dB設定" line51="        // FF+00+03+41=143=323(10)" line52="        Send_Uart_data([" line53="            255," line54="            0," line55="            3," line56="            65," line57="            TX_Power_data," line58="            (323 + TX_Power_data) % 256" line59="        ], 6)" line60="    }" line61="" line62="    //% blockId=Send_Uart_data block=&quot;ZETag Send uart data %text %text&quot;" line63="    export function Send_Uart_data(list: number[], e_num: number) {" line64="        o = 0" line65="        for (let n = 0; n &lt;= e_num - 1; n++) {" line66="            bserial.binserial_write(list[n])" line67="            basic.pause(5)" line68="        }" line69="    }" line70="" line71="    //% blockId=Set_Frequency block=&quot;ZETag Set Frequency %text %text %text&quot;" line72="    export function Set_Frequency(Frequency: number, CH_num: number, step: number) {" line73="        if (step == 0) {" line74="            o = 1" line75="        } else if (step &gt;= 2) {" line76="            o = 2" line77="        } else {" line78="            o = step" line79="        }" line80="        if (CH_num &lt;= 1) {" line81="            ch_num = -1" line82="        } else if (CH_num &gt; 6) {" line83="            ch_num = 6" line84="        } else {" line85="            ch_num = CH_num" line86="        }" line87="        Base_frequency = Frequency" line88="        CheckSum = 0" line89="        Para_array = [" line90="            255," line91="            0," line92="            8 + ch_num," line93="            64," line94="            1," line95="            Math.idiv(Base_frequency, 16777216)," line96="            Math.idiv(Base_frequency, 65536) % 256," line97="            Math.idiv(Base_frequency, 256) % 256," line98="            Base_frequency % 256," line99="            ch_num," line100="            0," line101="            0," line102="            0," line103="            0," line104="            0," line105="            0," line106="            0" line107="        ]" line108="        if (ch_num &gt;= 2) {" line109="            for (let Counter = 0; Counter &lt;= ch_num - 1; Counter++) {" line110="                Para_array[10 + Counter] = Counter * o" line111="            }" line112="        } else {" line113="            Para_array[4] = 0" line114="        }" line115="        Counter2 = 0" line116="        for (let index2 = 0; index2 &lt; ch_num + 10; index2++) {" line117="            CheckSum = CheckSum + Para_array[Counter2]" line118="            Counter2 += 1" line119="        }" line120="        CheckSum = CheckSum % 256" line121="        Para_array[10 + ch_num] = CheckSum" line122="        Send_Uart_data(Para_array, 11 + ch_num)" line123="    }" line124="}" numlines="125"></mutation></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></statement></block></xml>